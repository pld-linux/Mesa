--- mesa-mesa-20.0.5/src/gallium/targets/opencl/meson.build.orig	2020-04-22 23:35:13.000000000 +0200
+++ mesa-mesa-20.0.5/src/gallium/targets/opencl/meson.build	2020-04-25 17:05:51.190967800 +0200
@@ -31,6 +31,13 @@ endif
 
 llvm_libdir = dep_llvm.get_configtool_variable('libdir')
 
+polly_dep = null_dep
+polly_isl_dep = null_dep
+if dep_llvm.version().version_compare('>=10.0.0')
+  polly_dep = cpp.find_library('Polly', dirs : llvm_libdir, required : false)
+  polly_isl_dep = cpp.find_library('PollyISL', dirs : llvm_libdir, required : false)
+endif
+
 opencl_libname = with_opencl_icd ? 'MesaOpenCL' : 'OpenCL'
 
 dep_clang = cpp.find_library('clang-cpp', dirs : llvm_libdir, required : false)
@@ -49,6 +56,7 @@ if not dep_clang.found()
     cpp.find_library('clangEdit', dirs : llvm_libdir),
     cpp.find_library('clangLex', dirs : llvm_libdir),
     cpp.find_library('clangBasic', dirs : llvm_libdir),
+    polly_dep, polly_isl_dep,
   ]
 endif
 
